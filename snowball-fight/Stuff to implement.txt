Tell me which of these you want prioritized next:
A — Full local same-machine two-player (one window, two control schemes) with user-configurable fire keys.
B — Responsive / fullscreen scaling so the map fills the browser window while keeping input mapping correct.
C — Improve bots: add simple AI (move toward nearest human and occasionally throw).
D — Any UI polish you'd like on the home screen (styling, nicer selectors, name for each local player).
Immediate next steps I can take (pick one or more)

If you want A: I'll implement multiple sockets from one client, wire WASD+Space for player1 and ArrowKeys+Enter for player2 by default, and add UI to pick keys.
If you want B: I'll implement a camera (scale + translate) and map mouse coordinates correctly to world coords—this will also make the canvas effectively full-screen while keeping the internal MAP_WIDTH/MAP_HEIGHT.
If you want C: I'll add a simple server AI for bots (move/throw).
If you want D: I'll style the home modal/inputs.
Quick verification checklist I will run after your OK and logs:

Start frontend dev server — check for module errors (PASS/FAIL).
Start backend dev server — check for startup message (PASS/FAIL).
Open game in browser — verify canvas loads, left-click fires, players cannot walk through obstacles (manual test).
If bots chosen — verify bots appear in player list after Start.
If you want me to implement local 2-player next, say "Do A" (or "A then B" etc.). If you paste the fresh dev-server logs I can confirm the build errors are gone and continue immediately.


If the dev servers start cleanly, I can:
A — Implement local 2-player on same screen (two sockets + separate controls).
B — Add bot AI (move & shoot randomly/target nearest player).
C — Implement responsive/fullscreen scaling and correct mouse->world mapping.
D — Polish home screen UI.


When playing against bots, when I kill one bot, the game ends, but I want when all the bots or player is dead then the game end and player or bots wins. Also, I want the game to supports two real players against the bots.


I need option to return back to the main screen.

To save data in real database.


Show Leaderboard is not working, error:

Access to fetch at 'http://localhost:3001/leaderboard' from origin 'http://localhost:3000' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.
GameCanvas.tsx:609  GET http://localhost:3001/leaderboard net::ERR_FAILED 200 (OK)
onClick @ GameCanvas.tsx:609
callCallback @ react-dom.development.js:19467
invokeGuardedCallbackImpl @ react-dom.development.js:19516
invokeGuardedCallback @ react-dom.development.js:19591
invokeGuardedCallbackAndCatchFirstError @ react-dom.development.js:19605
executeDispatch @ react-dom.development.js:30661
processDispatchQueueItemsInOrder @ react-dom.development.js:30693
PROJECT: Snowball Fight — Implementation Notes & Roadmap
 
Last updated: 2025-11-09
 
Overview
--------
A single-file, concise roadmap for the game's near-term priorities, fixes, and feature backlog. Sections are: Priorities, Immediate next steps (pick one), Bugs & fixes, Features (short/long term), AI & gameplay, UX/UI polish, Backend & persistence, Testing & verification, and Next milestones.

Priorities (pick one or more to work on next)
-------------------------------------------
A — Local 2-player (same machine)
	- Support two local players in the same browser window with two control schemes.
	- Default controls: Player 1 = WASD + Space; Player 2 = Arrows + Enter (configurable in UI).
	- Each player should have independent name and color inputs.

B — Responsive / Fullscreen scaling
	- Implement camera (scale + translate) so the map fills the browser window while keeping input mapping correct.
	- Map mouse/window coordinates to world coordinates reliably at different resolutions and aspect ratios.

C — Improve bots (AI)
	- Add server-side simple AI: move toward nearest human, avoid obstacles, occasionally throw.
	- Add avoidance/dodging and obstacle-aware movement in later iteration.

D — Home-screen UI polish
	- Improve layout, styling and accessibility of the main menu and options.
	- Make controls, leaderboard, and settings more visible and usable.

Immediate next steps (choose one or more)
-----------------------------------------
- If you want A: implement local 2-player (multiple sockets or client-side dual-actor model), add key mapping UI for both players.
- If you want B: implement camera scaling and mouse->world mapping; ensure canvas resizes to fill available viewport.
- If you want C: implement simple server bot AI (pathing toward nearest player, occasional throws).
- If you want D: layout and style the main menu; add visible buttons for Controls, Leaderboard, Settings.

Bugs & Critical Fixes
---------------------
- CORS on leaderboard: backend needs Access-Control-Allow-Origin set (or use a proxy) so frontend can fetch `http://localhost:3001/leaderboard` from `http://localhost:3000`/dev server.
	- Quick fix: enable CORS in backend (allow http://localhost:3000 or *)

- Home menu overlay issues:
	- Main menu overlaps player info — adjust z-index / layout so main menu doesn't hide key UI.
	- "Show Leaderboard" button not visible on main screen — make it a primary action on the home modal.

- Local players UI:
	- When local players = 2, allow both players to input name and pick color (currently only one name).
	- Add UI for player-specific name/color, store both in localStorage keys like `snowball_name_1`, `snowball_name_2`.

- Controls button not working: check click handler and ensure modal toggles; add unit test for button wiring.

- Input focus/scrolling issues:
	- Arrow keys move the browser scrollbar when the canvas is smaller than the window; implement a camera that matches screen size or call `preventDefault()` for key handlers when the canvas is focused.

- Unexpected yellow rectangle spawn when firing: investigate debug drawing or leftover PIXI shape being drawn — see `pictureErrors/` for screenshot. Remove debug visuals or gate them behind a debug flag.

- Snowballs persisting across restarts/main menu: when leaving the game, ensure the PIXI app and socket state are fully cleaned up; optionally prompt user to confirm leaving the current game and restart the scene.

- Bots walking through obstacles: collision detection for bots must be enforced (same system as players). Prevent bots from overlapping obstacle bounding boxes.

Performance / Lag
-----------------
- If you observe lag when multiple entities are present:
	- Profile CPU usage, page paint and JS event loop.
	- Reduce PIXI draw calls, reuse Graphics objects, and ensure `app.ticker` is not running while paused.
	- Limit spawn frequency for snowball effects and particle animations.

Gameplay & Features backlog
---------------------------
Short-term (implement during Phase 1):
- Shield item: spawns on map, can be picked up. Shield has its own HP; hits on shield reduce shield HP, hits on unshielded side reduce player HP.
- Speed boost item: temporary boost of movement speed.
- Timer option for matches (60/120/180/240/300s or custom/none).
- Local 2-player support (A above). Make UI for player-specific settings.
- Team modes: 2v2 local or bots.

Mid-term:
- Power-ups: spawn randomly, disappear after timeout, include homing snowball, triple throw, screen-darkening item.
- Better AI: dodging, hiding behind obstacles, collecting power-ups, predicting movement.
- HUD improvements: FPS/milliseconds counter, player's inventory, active power-ups.

Long-term:
- Dynamic terrain, weather effects, moving obstacles, extra maps.
- Online multiplayer with matchmaking and persistence.

AI / Bot improvements
---------------------
- Phase 1: simple behavior
	- Move toward nearest human player while avoiding overlapping obstacles; throw occasionally at a predicted location.

- Phase 2: intermediate behavior
	- Dodging logic (when incoming snowball predicted to collide), hiding near obstacles, collecting power-ups.

- Phase 3: advanced behavior
	- Smarter prediction, team play, difficulty levels (easy/medium/hard).

UX / UI Polishing
-----------------
- Main menu: clearer layout with buttons for Start, Controls, Leaderboard, Settings, Quit.
- Controls modal: show current key mapping and allow remapping per player.
- Player setup: if Local players > 1 show separate rows for each player's name & color.
- Leaderboard: fix CORS and improve visibility and position.
- Add a small persistent FPS/latency readout (top-right) for debugging.

Backend & Persistence
---------------------
- Leaderboard endpoint currently blocked by CORS — add CORS headers on backend.
- Consider moving leaderboard to a real DB (SQLite or PostgreSQL) instead of `data/leaderboard.json` for persistence and concurrency.
- Add endpoints for saving match results and querying top scores.

Testing & Verification
----------------------
Quick verification checklist (run after changes):
- Start frontend dev server — check for module errors (PASS/FAIL).
- Start backend dev server — check for startup message (PASS/FAIL).
- Open game in browser — verify canvas loads and Start Game mounts the canvas.
- Verify both local players can control distinct players if A implemented.
- If bots are enabled — verify bots appear and observe basic bot behavior.

Developer Notes
---------------
- When cleaning up the game (leaving to menu) ensure sockets are disconnected and PIXI app destroyed to avoid leftover listeners/objects.
- Use `window.requestAnimationFrame`/PIXI ticker conservatively; stop ticker when modal open.
- Keep collision detection centralized so both bots and players use the same checks.

Milestones
----------
Phase 1 (MVP):
- Local 2-player support (A)
- Responsive fullscreen scaling (B)
- Simple bot AI and basic item pickups (C)
- Polished main menu, controls modal, and leaderboard CORS fix (D + backend)

Phase 2:
- Improved bot AI, power-ups, timer modes, HUD polish, performance optimizations.

Phase 3:
- Online multiplayer, persistence, release polish, extra maps and modes.

Next actions for me (pick one):
- "Do A" — implement Local 2-player (controls + UI) now.
- "Do B" — implement responsive fullscreen scaling and mouse->world mapping.
- "Do C" — implement simple server-side bot AI.
- "Do D" — polish home screen UI and fix the referenced bugs (controls button, leaderboard visibility).

If you want, paste the latest terminal logs for the dev servers and I will begin the chosen task and run the verification checklist.

Notes from user (kept for reference)
-----------------------------------
- Player defaults to name "Marko"; allow user-editable names.
- Leaderboard CORS error (see original stack trace) — backend needs CORS headers.
- When setting local players to two we need both players to choose name and color.
- Controls button not doing anything — needs wiring.
- Arrow-keys move the page when canvas doesn't fill the window — implement fullscreen scaling or preventDefault when canvas focused.
- Yellow rectangle sometimes appears on firing — remove debugging visuals.
- When returning to main menu, consider confirming and/or restarting the game state; ensure previous snowballs are cleared.
- Bots should not pass through obstacles and occasionally dodge.
- Add items/power-ups: shields (with HP), speed boost, homing snowball, triple throw, temporary screen darken.
- Add timer option to match settings.
- Add FPS and latency displays.
- Improve obstacle HP reset at new game start.
- Investigate lag when multiple bots/players present.

Visual Identity

Design a simple logo, menu background, and maybe character icons.

Choose a consistent art style (cartoonish, low-poly, pixel-art, etc.)

Add themed maps (forest, village, mountain).

Public Alpha / Beta Release

When it’s fun and stable:

Upload to itch.io, Steam (early access), or share as a web build.

Collect player feedback and crash reports.

Watch gameplay videos to understand how people really play.

Next Development Phase (Phase 2)

Depending on your direction:

Add progression (levels, ranks, unlocks).

Add new abilities / snowball types.

Improve AI learning.

Expand to mobile version or multiplayer ranking system.

By default it takes for now name Marko, but I would like that player can enter the name for himself, maybe in future to
save names.

Leaderboard option is not that visible.

I now do not have that button on the main menu for seeing the controls.

Main menu is on top of the payer info. Fix it.

Functionality for local players is not working.

Add fps and ms.

Make that user can pick the color that he wants from like pallet of colors.

Health bar of the obstacles to be full with every new game.

Why for some reason, there is one player and bot and we are throwing snowballs and I see the lags.